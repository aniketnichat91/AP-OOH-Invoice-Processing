App As appinfo:
    BackEnabled: =false
    OnStart: |
        =// Obtain username and email of the logged-in user
        //Set Logged in User for the App
        Set(
            varLoggedInUser,
            User()
        );
        // Find the user with a matching email in the App Users list
        With(
            {
                wUserRecord: LookUp(
                    'fa-interface-users',
                    Title = varLoggedInUser.Email
                )
            },
            Set(
                varUser,
                wUserRecord.Title
            );
            Set(
                varIsQA,
                wUserRecord.IsQA
            );
            Set(
                varRole,
                wUserRecord.Role.Value
            );
            ClearCollect(
                varTeamUsers,
                wUserRecord.TeamUsers.Value
            );
            
        );
        
            ClearCollect(
                colLeftNavMenu,
                Table(
                    {
                        Menulabel: "Home",
                        MenuIcon: Icon.Home,
                        MenuScreenNavigate: HomeScreen,
                        MenuID: 1
                    },
                    {
                        Menulabel: "Process Journey Screen",
                        MenuIcon: Icon.Note,
                        MenuScreenNavigate: ProcessJourneyScreen,
                        MenuID: 2
                    }
                    ,
                    {
                        Menulabel: "Mail Processing - Workato Screen",
                        MenuIcon: Icon.DetailList,
                        MenuScreenNavigate: MailProcessingWorkatoScreen,
                        MenuID: 3
                    }
                    ,
                    {
                        Menulabel: "DML Operations - Update Screen",
                        MenuIcon: Icon.Bookmark,
                        MenuScreenNavigate: DMLOperationsUpdateScreen,
                        MenuID: 4
                    },
                    {
                        Menulabel: "Form Rec Training Screen",
                        MenuIcon: Icon.Laptop,
                        MenuScreenNavigate: FormRecTrainingScreen,
                        MenuID: 5
                    },
                    {
                        Menulabel: "Logs Screen",
                        MenuIcon: Icon.LogJournal,
                        MenuScreenNavigate: LogsScreen,
                        MenuID: 6
                    }          
                )
            );

